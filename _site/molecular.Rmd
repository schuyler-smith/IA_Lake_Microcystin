---
title: "Molecular Analysis"
author: <a href="https://schuyler-smith.github.io/" target="_blank" >Schuyler D. Smith</a>
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
    code_folding: hide
editor_options: 
  chunk_output_type: console
---
```{r setup, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```
<br>
<br>

# Abiotic Factors
## NO2 {.tabset .tabset-pills}
### Year Average {.tabset .tabset-pills}
```{r nitrogen}
nitrogen <- metadata[, lapply(.SD, mean, na.rm=TRUE), by=c("Location", "Year"), .SDcols=c("NO2")][order(Location)]
set(nitrogen, j = "NO2", value = round(nitrogen$NO2, 3))
```

#### Graph
```{r nitro_graph, echo=FALSE}
ggplot(nitrogen, aes(Location, NO2, fill = Year)) + 
  geom_bar(stat = "identity", position = position_dodge2(padding = 3.5), 
    size = 0.2, color = "black", alpha = 0.75, width = 0.32) +
  coord_flip() + 
  theme(axis.text.y = element_text(color = lake_risk, face = "bold"))
```

#### Table
```{r nitro_out, echo=FALSE}
nitrogen
```

### Microcystin Correlation
```{r nitro_correlation, echo=FALSE}
ggplot(metadata, aes(NO2, Microcystin)) + 
  geom_point(aes(color = Microcystin)) + 
  viridis::scale_color_viridis()
```

## NH3 {.tabset .tabset-pills}
### Year Average {.tabset .tabset-pills}
```{r NH3}
NH3 <- metadata[, lapply(.SD, mean, na.rm=TRUE), by=c("Location", "Year"), .SDcols=c("NH3")][order(Location)]
set(NH3, j = "NH3", value = round(NH3$NH3, 3))
```

#### Graph
```{r NH3_graNH3, echo=FALSE}
ggplot(NH3, aes(Location, NH3, fill = Year)) + 
  geom_bar(stat = "identity", position = position_dodge2(padding = 3.5), 
    size = 0.25, color = "black", alNH3a = 0.5, width = 0.30) +
  coord_flip() + 
  theme(axis.text.y = element_text(color = lake_risk, face = "bold"))
```

#### Table
```{r NH3_out, echo=FALSE}
NH3
```

### Microcystin Correlation
```{r NH3_correlation, echo=FALSE}
ggplot(metadata, aes(NH3, Microcystin)) + 
  geom_point(aes(color = Microcystin)) + 
  viridis::scale_color_viridis()
```

## pH {.tabset .tabset-pills}
### Year Average {.tabset .tabset-pills}
```{r pH}
pH <- metadata[, lapply(.SD, mean, na.rm=TRUE), by=c("Location", "Year"), .SDcols=c("pH")][order(Location)]
set(pH, j = "pH", value = round(pH$pH, 2))
```

#### Graph
```{r pH_graph, echo=FALSE}
ggplot(pH, aes(Location, pH, fill = Year)) + 
  geom_bar(stat = "identity", position = position_dodge2(padding = 3.5), 
    size = 0.2, color = "black", alpha = 0.75, width = 0.32) +
  coord_flip() + 
  theme(axis.text.y = element_text(color = lake_risk, face = "bold"))
```

#### Table
```{r pH_out, echo=FALSE}
pH
```

### Microcystin Correlation
```{r pH_correlation, echo=FALSE}
ggplot(metadata, aes(pH, Microcystin)) + 
  geom_point(aes(color = Microcystin)) + 
  viridis::scale_color_viridis()
```


## Cl {.tabset .tabset-pills}
### Year Average {.tabset .tabset-pills}
```{r Cl}
Cl <- metadata[, lapply(.SD, mean, na.rm=TRUE), by=c("Location", "Year"), .SDcols=c("Cl")][order(Location)]
set(Cl, j = "Cl", value = round(Cl$Cl, 2))
```

#### Graph
```{r Cl_graCl, echo=FALSE}
ggplot(Cl, aes(Location, Cl, fill = Year)) + 
  geom_bar(stat = "identity", position = position_dodge2(padding = 3.5), 
    size = 0.2, color = "black", alCla = 0.75, width = 0.32) +
  coord_flip() + 
  theme(axis.text.y = element_text(color = lake_risk, face = "bold"))
```

#### Table
```{r Cl_out, echo=FALSE}
Cl
```

### Microcystin Correlation
```{r cl_correlation, echo=FALSE}
ggplot(metadata, aes(Cl, Microcystin)) + 
  geom_point(aes(color = Microcystin)) + 
  viridis::scale_color_viridis()
```

# Microcystin Strains
## 

